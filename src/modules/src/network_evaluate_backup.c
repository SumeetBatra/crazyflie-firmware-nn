#include "network_evaluate.h"
#include "debug.h"
#include "param.h"
#include <string.h>


//#include <math.h>
//#include <random>
//#include <vector>
//#include <iostream>
//#include <algorithm>
//
//#define NEIGHBORS 2
//#define NUM_OBS 6
//
///*
// * since the network outputs thrust on each motor,
// * we need to define a struct which stores the values
//*/
//typedef struct control_t_n {
//    float thrust_0;
//    float thrust_1;
//    float thrust_2;
//    float thrust_3;
//} control_t_n;
//
//void networkEvaluate(control_t_n *control_n, const float *state_array);
//void neighborEmbeddings(const float neighbor_array[NEIGHBORS][NUM_OBS]);


float linear(float num) {
	return num;
}



float sigmoid(float num) {
	return 1 / (1 + exp(-num));
}



float relu(float num) {
	if (num > 0) {
		return num;
	} else {
		return 0;
	}
}

static const int structure [6][2] = {{18, 16},{16, 16},{6, 8},{8, 8},{24, 32},{32, 4}};
static float output_0[8];
//static float output_1[8];
static float output_2[16];
static float output_3[16];
static float output_4[32];
static float output_5[4];
static float neighbor_embeds[8];
static float embedding_array[24];
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_weight[6][8] = {{0.4581316411495209,0.2149747759103775,0.6940745711326599,-0.32455217838287354,-0.928033709526062,0.425619900226593,-1.1888482570648193,-0.45289602875709534},{0.4642367362976074,0.050693295896053314,0.6254351139068604,1.4659340381622314,0.6437460780143738,0.17432230710983276,-0.6228200793266296,-0.8379110097885132},{0.40195608139038086,0.15383276343345642,0.26772162318229675,0.7558892965316772,-0.40451082587242126,-0.10646558552980423,0.3156394064426422,-0.9176162481307983},{-0.1210542544722557,0.43212711811065674,-0.6450530886650085,0.2495788037776947,0.1440756767988205,0.42476776242256165,-0.2141178548336029,0.18564993143081665},{-0.2024913877248764,0.0666583925485611,-0.3926975429058075,0.09131833910942078,0.13434728980064392,0.5037714838981628,0.5794278979301453,0.22911995649337769},{-0.3226950466632843,-0.6520523428916931,-0.01952490769326687,0.48654937744140625,0.17463436722755432,0.30314406752586365,0.440980464220047,-0.12646602094173431}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_weight[8][8] = {{-0.40263381600379944,0.23518171906471252,-0.42067745327949524,0.6134162545204163,0.13151995837688446,0.0059425970539450645,0.3132413923740387,0.5858476758003235},{-0.38503122329711914,-0.41647449135780334,-0.5792484879493713,-0.17138643562793732,0.6211992502212524,-0.6060176491737366,-0.4818606376647949,-0.011957417242228985},{-0.007139638997614384,-0.48896896839141846,-0.351273775100708,0.6032260656356812,0.9038930535316467,0.36843782663345337,-0.18367905914783478,-0.5305742025375366},{0.42065468430519104,-0.17090052366256714,-0.140739306807518,-0.7408968210220337,0.5113433599472046,0.06076652929186821,0.5978439450263977,-0.09237011522054672},{-0.13565774261951447,0.3286878168582916,0.13520017266273499,-0.6949068903923035,-0.0029932204633951187,0.06808479875326157,0.7407163381576538,-0.01287758257240057},{-0.5556654930114746,-0.032355040311813354,-0.19712799787521362,0.49186596274375916,0.3861565589904785,-0.3797333538532257,-0.1181306540966034,0.1715075522661209},{-0.228597491979599,-0.11618481576442719,-0.10183888673782349,-0.5638748407363892,-0.0910048559308052,-0.38341593742370605,0.825114369392395,-0.6096370816230774},{0.5451486706733704,-0.16312862932682037,-0.21349479258060455,0.31961533427238464,-1.1807212829589844,0.04783400520682335,0.399361252784729,0.39609119296073914}};
static const float actor_encoder_self_encoder_0_weight[18][16] = {{-0.49271929264068604,-0.21273760497570038,0.0031220167875289917,0.0017000831430777907,-0.05299437418580055,0.09051531553268433,-0.030524209141731262,-0.15858927369117737,-0.1311132162809372,-0.6053292751312256,-0.2634369730949402,0.04000404477119446,0.017825353890657425,-0.22940491139888763,0.168331116437912,-0.17797806859016418},{-0.005389777477830648,0.19165165722370148,-0.34697920083999634,-0.0775766521692276,-0.03730225935578346,-0.2146521657705307,0.08799435198307037,-0.4701988697052002,0.018065880984067917,0.12475985288619995,-0.04502200335264206,0.25280657410621643,-0.19735746085643768,0.1794515997171402,-0.46761903166770935,0.10007156431674957},{0.5300981402397156,-0.23680996894836426,-0.08444878458976746,0.2337268590927124,-0.031169317662715912,0.5051639676094055,0.2532912492752075,0.32542815804481506,-0.4309154748916626,-0.22761917114257812,-0.14872483909130096,0.13774226605892181,-0.3384709358215332,-0.13812355697155,-0.3414055407047272,0.19642038643360138},{-0.06186199188232422,-0.08981471508741379,-0.2608911097049713,-0.10815075784921646,0.03120809979736805,0.013508407399058342,-0.0987941175699234,-0.14204874634742737,0.08394762873649597,-0.5064004063606262,-0.14890745282173157,-0.2243751436471939,-0.12425994127988815,-0.1350989192724228,0.30551642179489136,0.20010724663734436},{-0.018981419503688812,-0.48695164918899536,-0.37327876687049866,0.004697228316217661,0.06841442734003067,-0.09984828531742096,0.30304017663002014,-0.552859365940094,0.06338010728359222,-0.07255717366933823,0.2166266292333603,-0.2599814534187317,0.4886854887008667,-0.09093855321407318,-0.43157127499580383,-0.08950076252222061},{0.14550334215164185,-0.4024791121482849,-0.18913604319095612,0.006869075819849968,0.0031935551669448614,0.44186580181121826,-0.06757515668869019,-0.03440013900399208,-0.46825313568115234,-0.3364804983139038,-0.006423732731491327,-0.07957340776920319,0.017915794625878334,0.04105588048696518,0.21035145223140717,-0.13410848379135132},{-0.25737306475639343,-0.15743276476860046,-0.27510276436805725,0.6499075889587402,-0.11279560625553131,-0.09878972917795181,-0.04713312163949013,0.10214823484420776,0.1984115093946457,0.16600202023983002,0.030329426750540733,0.15110184252262115,-0.3175109922885895,-0.48785898089408875,-0.11462787538766861,0.32689958810806274},{-0.4388822913169861,0.19502456486225128,-0.16703806817531586,0.08025360107421875,0.18975871801376343,-0.3716416656970978,0.23922769725322723,0.11614011973142624,-0.03791647404432297,0.12954926490783691,0.1420966237783432,-0.13839538395404816,-0.6255502700805664,-0.2510819435119629,-0.4687116742134094,-0.07523351162672043},{-0.5139014720916748,0.37887701392173767,-0.08762222528457642,-0.2571621239185333,-0.4114590287208557,0.14143525063991547,-0.3184431195259094,-0.0944548174738884,-0.24827931821346283,0.3124311566352844,-0.5066154599189758,0.08548422902822495,0.24250267446041107,-0.03912367671728134,0.44003936648368835,-0.4354652166366577},{0.1998189091682434,-0.4035213887691498,-0.13960309326648712,-0.08983919024467468,-0.3493569493293762,-0.23686903715133667,-0.17380422353744507,-0.18323096632957458,-0.10429836809635162,-0.2150401920080185,-0.4553672969341278,0.16679523885250092,0.22233045101165771,0.25400349497795105,0.14015942811965942,-0.6649119257926941},{0.25620418787002563,-0.2506752908229828,-0.1908266395330429,0.4383215308189392,-0.7401882410049438,-0.01730957254767418,-0.6451433300971985,-0.2647477686405182,-0.0761033296585083,-0.046412259340286255,-0.17774011194705963,-0.05206935107707977,0.0664592832326889,0.12144049257040024,-0.37784767150878906,-0.006846277974545956},{0.22099770605564117,-0.1434563845396042,-0.2215718775987625,0.119585320353508,-0.3710493743419647,-0.08403225243091583,0.7569166421890259,-0.6993379592895508,0.013388549908995628,0.03731877729296684,-0.05446077883243561,-0.6310115456581116,0.011542578227818012,0.42295414209365845,-0.33690470457077026,-0.251227468252182},{-0.3722389340400696,0.3128530979156494,0.3070167005062103,0.6361770629882812,0.6173167824745178,-0.004028909374028444,-0.286592960357666,0.5233280658721924,-0.5105777978897095,-0.23450300097465515,-0.3181505501270294,0.2660638391971588,0.706372857093811,-0.8274206519126892,0.05500194430351257,0.34303489327430725},{-0.315729558467865,0.014413860626518726,-0.22416779398918152,-0.18257538974285126,-0.2560338079929352,0.2965765595436096,0.11456622183322906,-0.6617714762687683,0.18864178657531738,-0.40550923347473145,-1.0982577800750732,-0.5128415822982788,-0.05877481400966644,-0.7785030007362366,0.13551104068756104,0.15596215426921844},{-0.03101850301027298,0.20396840572357178,-0.2773585915565491,0.5112721920013428,0.4053788483142853,-0.0899210199713707,-0.16148938238620758,0.15903045237064362,0.260422021150589,0.07782372087240219,-0.11094886064529419,0.33785930275917053,0.04988754168152809,-0.3334943652153015,-0.4325817823410034,-0.12065587937831879},{0.18774597346782684,0.16820453107357025,-0.3165808916091919,-0.18270839750766754,-0.10118976980447769,-0.12077336758375168,0.0005499158287420869,-0.12451265007257462,0.34268683195114136,-0.14989663660526276,-0.22717110812664032,0.0018116128630936146,-0.10908550024032593,-0.2972088158130646,0.11364547163248062,0.29082435369491577},{-0.23694801330566406,0.11732331663370132,-0.24470661580562592,-0.057351186871528625,-0.08663501590490341,0.31472474336624146,0.33885303139686584,-0.34005671739578247,-0.18913519382476807,0.01200186088681221,0.09966202825307846,-0.41196468472480774,0.05316058173775673,0.1599908471107483,-0.19545899331569672,0.2244953066110611},{0.10026158392429352,0.027953850105404854,0.05217677727341652,-0.3151997923851013,0.2366495281457901,0.17351655662059784,0.13376785814762115,-0.15218155086040497,-0.026677442714571953,0.25595447421073914,0.15698352456092834,-0.33353063464164734,-0.2489791214466095,-0.21780827641487122,0.021068133413791656,-0.4188542366027832}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.07329922914505005,-0.32253792881965637,-0.12904493510723114,-0.1678536981344223,0.10328543186187744,0.03441092371940613,-0.10047242790460587,0.32648688554763794,0.22129212319850922,0.29587170481681824,-0.31823214888572693,-0.22588767111301422,0.16248057782649994,-0.5106152296066284,0.16853822767734528,0.1046857014298439},{-0.14957886934280396,-0.15511363744735718,-0.24578674137592316,0.30227330327033997,-0.24157120287418365,-0.0574679933488369,0.1772860437631607,0.23451314866542816,0.22967329621315002,-0.22847290337085724,-0.2209305614233017,0.10851950943470001,-0.24786651134490967,0.14285393059253693,-0.22227555513381958,-0.08029047399759293},{-0.35264042019844055,-0.17284561693668365,0.1605181246995926,0.3426116704940796,-0.07112857699394226,-0.38309991359710693,0.4313710033893585,-0.2167554497718811,-0.044744960963726044,-0.012958033010363579,0.023509331047534943,-0.28531360626220703,-0.22268491983413696,-0.34641557931900024,-0.08935890346765518,0.04853464663028717},{0.22643035650253296,-0.5251314640045166,0.3503744602203369,-0.12856432795524597,0.3759554624557495,0.0584440641105175,-0.37324804067611694,-0.21054421365261078,0.06606926023960114,0.32999518513679504,-0.43944984674453735,0.18300148844718933,-0.4507504999637604,0.04520169645547867,0.36017635464668274,0.25743991136550903},{-0.1458444744348526,-0.050336480140686035,-0.413968026638031,-0.20791995525360107,-0.008304761722683907,-0.12115143239498138,0.654630184173584,-0.3868924677371979,0.19010210037231445,-0.032017286866903305,-0.47571709752082825,0.3368157744407654,0.4068889915943146,0.26016122102737427,-0.006367255002260208,0.4320833384990692},{-0.02585669606924057,0.05478886887431145,0.1911405473947525,-0.41065192222595215,0.4307871460914612,-0.32592663168907166,-0.05834835395216942,-0.032154519110918045,0.1891888678073883,0.24465815722942352,0.17380601167678833,0.24940736591815948,-0.24369798600673676,-0.24389679729938507,-0.22923201322555542,0.40441274642944336},{0.2817969024181366,0.06634805351495743,-0.18662576377391815,0.2625008523464203,-0.2136327028274536,0.34943246841430664,0.37856200337409973,0.4174908399581909,0.3394571840763092,-0.08233638852834702,0.06762910634279251,-0.3605494499206543,0.39246609807014465,0.21883800625801086,-0.11715429276227951,0.12027420848608017},{-0.3337796628475189,0.19019797444343567,-0.13431453704833984,-0.09190396964550018,0.2962142825126648,-0.05967894569039345,0.31013524532318115,0.18985134363174438,-0.20866577327251434,-0.07504083961248398,-0.37177422642707825,0.29755493998527527,0.007091349456459284,-0.10319778323173523,-0.22435955703258514,0.21063221991062164},{0.2503282427787781,0.05020304024219513,0.31131768226623535,0.33277183771133423,-0.23280419409275055,-0.2810576558113098,-0.4316050410270691,-0.040618643164634705,-0.18793265521526337,0.09771305322647095,0.024015313014388084,0.33583003282546997,0.2706327438354492,-0.3195815682411194,-0.31078293919563293,-0.2091185599565506},{0.16072013974189758,-0.12851323187351227,-0.03285273164510727,0.17665475606918335,0.036425575613975525,-0.45859581232070923,0.041744135320186615,0.42247068881988525,0.13384190201759338,0.07792703062295914,0.06878287345170975,-0.12085921317338943,-0.07986889779567719,-0.24371126294136047,0.18584467470645905,0.24859993159770966},{0.3877532482147217,-0.283522367477417,-0.4499336779117584,0.2675691545009613,-0.09937401860952377,-0.3635319471359253,0.2891182005405426,0.48102015256881714,-0.25595715641975403,0.18383288383483887,-0.1516532450914383,-0.0737035870552063,-0.10215231031179428,0.31762927770614624,0.4726090729236603,0.23548977077007294},{-0.05846673622727394,-0.22412973642349243,0.319326251745224,-0.20761270821094513,0.275982141494751,0.23725637793540955,-0.11434484273195267,-0.12692292034626007,0.23128332197666168,0.2611670196056366,-0.23456022143363953,0.20447197556495667,-0.12435746192932129,-0.29176416993141174,0.17506587505340576,0.231896311044693},{0.025989823043346405,-0.10667341202497482,-0.05338788032531738,0.2171703428030014,0.1625664383172989,-0.09682320058345795,0.14518101513385773,-0.01913626864552498,-0.3443070948123932,-0.23335500061511993,0.32556575536727905,0.32729047536849976,-0.14718376100063324,0.3317502439022064,0.22149866819381714,-0.0815398320555687},{0.0036801749374717474,-0.28855034708976746,-0.30761486291885376,0.3408382534980774,0.2769733965396881,-0.12136543542146683,-0.25244906544685364,0.22478143870830536,0.1066100150346756,-0.015630410984158516,-0.15869644284248352,-0.6045580506324768,0.33362817764282227,0.1553855687379837,0.025934802368283272,-0.2537296414375305},{-0.2488328069448471,-0.23159641027450562,-0.1657930463552475,-0.13834042847156525,0.1255415827035904,-0.2414582222700119,-0.10468357056379318,0.0030831254553049803,0.16007746756076813,-0.002839881693944335,0.41045287251472473,0.3705228865146637,-0.09268423169851303,0.13434718549251556,0.15728971362113953,0.0726749449968338},{0.14748358726501465,-0.07857178896665573,0.3192117512226105,0.02831697091460228,0.17413385212421417,0.35503435134887695,0.3395664095878601,0.07601149380207062,-0.1536637395620346,0.35894402861595154,-0.2553515136241913,0.011813326738774776,-0.06091329827904701,-0.29543182253837585,0.10900472104549408,0.09792084246873856}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{0.22303037345409393,0.26628753542900085,-0.19249695539474487,0.14334508776664734,0.11526404321193695,0.06812411546707153,0.26694467663764954,-0.3008962571620941,-0.013800063170492649,-0.013027165085077286,0.29532840847969055,-0.21927693486213684,0.016196763142943382,0.31871944665908813,-0.02282669022679329,0.2719363272190094,0.2607487738132477,0.1766292005777359,0.2700622081756592,0.2341000735759735,-0.2030021995306015,-0.11755690723657608,0.06938270479440689,0.26532942056655884,0.11314534395933151,0.2957736551761627,-0.2781383693218231,-0.27991676330566406,-0.18544122576713562,0.25507333874702454,-0.13875307142734528,0.24618074297904968},{0.19978268444538116,-0.0539647601544857,0.23779462277889252,-0.11160574108362198,0.10078120231628418,-0.3629359006881714,0.1249038502573967,0.12557636201381683,-0.2298172563314438,-0.29198595881462097,0.07374957948923111,-0.0018205019878223538,0.2010899931192398,-0.15065038204193115,-0.12724655866622925,0.17318876087665558,0.03562626242637634,-0.06369752436876297,0.1202968955039978,-0.05756697058677673,0.062213268131017685,-0.17387576401233673,0.4282241761684418,-0.16717123985290527,0.1867019236087799,0.2981652319431305,0.18012522161006927,0.31345319747924805,-0.060997374355793,0.23975516855716705,0.14321355521678925,0.137041836977005},{0.12586988508701324,0.015904821455478668,0.22758877277374268,-0.3177717626094818,0.17544500529766083,-0.19249846041202545,-0.16037511825561523,-0.20175659656524658,0.13304363191127777,0.32957544922828674,0.14923109114170074,0.008676134049892426,0.054429516196250916,0.049724381417036057,-0.04364512115716934,0.25915443897247314,-0.17856556177139282,-0.23301327228546143,0.07557255029678345,-0.03227906674146652,-0.3304797410964966,0.331830769777298,-0.0702156126499176,-0.18026745319366455,-0.03642987459897995,-0.16655991971492767,-0.02229270339012146,-0.02958650328218937,-0.2769600450992584,-0.07428763806819916,0.24979044497013092,0.23501811921596527},{0.2088300585746765,0.07209047675132751,-0.2479352056980133,-0.39754718542099,-0.3030034303665161,-0.3405578136444092,0.1695747822523117,0.1969231218099594,-0.06346213817596436,0.17737147212028503,-0.28492093086242676,-0.15643441677093506,-0.16830502450466156,-0.1239342913031578,-0.15844863653182983,-0.027400372549891472,-0.3442849814891815,-0.2803403437137604,0.15219631791114807,0.06638382375240326,0.04390188679099083,0.26509442925453186,-0.22557313740253448,-0.06957549601793289,0.22115622460842133,0.07215295732021332,0.3672061264514923,-0.25057607889175415,-0.07446634769439697,-0.3272738456726074,-0.3820880651473999,0.11874066293239594},{-0.056427210569381714,-0.06089704483747482,-0.23471976816654205,0.03536361828446388,0.3207298815250397,0.015119307674467564,0.1691722273826599,0.21576732397079468,0.05008005350828171,0.42012956738471985,-0.15673722326755524,-0.2571406662464142,0.017670178785920143,0.17221438884735107,0.11367936432361603,0.05254675820469856,-0.20527400076389313,-0.38087198138237,-0.36214375495910645,0.33146971464157104,-0.00412770127877593,-0.4404224455356598,-0.24830615520477295,-0.22843970358371735,-0.07334218174219131,0.3943140506744385,0.13519851863384247,0.2624925374984741,-0.1436634361743927,-0.03994213417172432,0.12943822145462036,-0.2067146748304367},{0.341459184885025,-0.19661428034305573,-0.2652607262134552,-0.20779381692409515,0.16833044588565826,-0.0356668122112751,-0.1338168829679489,-0.0026482781395316124,0.2679847776889801,0.3283364474773407,-0.1970783919095993,0.1367296725511551,0.285270094871521,-0.2888985276222229,0.22395193576812744,-0.20259328186511993,-0.07311207801103592,0.20237037539482117,0.03317810967564583,0.28267866373062134,0.1765081137418747,0.03312750533223152,-0.1961212158203125,-0.005538306199014187,-0.27772024273872375,0.04422491043806076,0.04578535631299019,0.18251006305217743,-0.05348994955420494,0.13815519213676453,0.1691197007894516,-0.1362672597169876},{0.24240919947624207,-0.10069462656974792,0.22302106022834778,-0.08741766959428787,-0.3021615445613861,-0.1776881217956543,0.3208368718624115,-0.27310532331466675,0.16859546303749084,0.12157496809959412,-0.16387152671813965,0.07499821484088898,-0.01185600645840168,0.09238407760858536,-0.061660267412662506,0.03748023509979248,0.04095574468374252,-0.04857593774795532,-0.06721260398626328,-0.31827202439308167,0.07214698195457458,-0.2575753331184387,-0.14260143041610718,-0.25645649433135986,0.0485965758562088,-0.30307549238204956,0.10036016255617142,0.05415674299001694,0.2713392674922943,0.12947578728199005,0.0021941333543509245,0.07637089490890503},{0.3331490755081177,-0.19269953668117523,-0.3014466166496277,0.2269672453403473,-0.13030581176280975,0.17259573936462402,0.220717653632164,-0.27348387241363525,-0.0728301852941513,-0.2653774619102478,-0.21716754138469696,-0.36463069915771484,-0.24947109818458557,-0.22237208485603333,0.10515327006578445,0.31987860798835754,0.36770081520080566,-0.28077414631843567,0.027430228888988495,0.0010234132641926408,-0.08726414293050766,-0.18326526880264282,-0.21375305950641632,0.27366384863853455,-0.1597825586795807,-0.009284412488341331,-0.20307126641273499,-0.006158881820738316,-0.2578689157962799,-0.04247194901108742,-0.24557863175868988,-0.14467068016529083},{0.29514560103416443,0.14672866463661194,-0.07849588245153427,-0.11124774068593979,0.26261091232299805,0.24190616607666016,0.13399812579154968,0.01558663509786129,0.19669568538665771,-0.16149219870567322,0.26419904828071594,0.05358801782131195,0.1649232804775238,-0.1192987710237503,0.2746018171310425,0.10040423274040222,0.05156039446592331,0.11297959089279175,-0.23006129264831543,-0.17622970044612885,0.06930843740701675,0.2186790108680725,-0.08864153176546097,-0.3302149176597595,-0.20172321796417236,-0.005866379011422396,0.1423516422510147,-0.007680169772356749,0.1861264407634735,-0.23978295922279358,-0.004797823261469603,-0.03690200299024582},{-0.22267480194568634,-0.03682977333664894,0.1571628600358963,-0.21504420042037964,0.010944157838821411,0.41658514738082886,0.20156462490558624,-0.14855103194713593,-0.2040158212184906,0.08274604380130768,0.21612440049648285,0.01675434038043022,-0.12991420924663544,0.2195945531129837,-0.18808726966381073,-0.24100461602210999,0.18351055681705475,-0.2521549463272095,-0.0019613374024629593,0.14406763017177582,0.35866087675094604,0.118782639503479,0.17785577476024628,-0.08277946710586548,0.07721225917339325,0.167112335562706,0.19703365862369537,0.3214428126811981,-0.13525819778442383,-0.04576849564909935,0.018751179799437523,0.2844226658344269},{0.15444603562355042,-0.26375308632850647,-0.16239145398139954,-0.011420376598834991,-0.020278325304389,0.136392742395401,-0.31245872378349304,0.05786953493952751,-0.305311381816864,-0.39944079518318176,0.2832850217819214,-0.008334572426974773,0.0199980940669775,-0.27661043405532837,-0.029260536655783653,-0.11103128641843796,0.12720133364200592,0.11553525924682617,-0.02621244266629219,0.15095822513103485,0.08469140529632568,0.0304535161703825,0.13603346049785614,0.27044159173965454,0.1656399518251419,-0.3666653037071228,0.0042646583169698715,0.1329682171344757,-0.12579794228076935,-0.1826597899198532,0.17602041363716125,0.11985277384519577},{0.18378330767154694,0.29641616344451904,0.22957094013690948,-0.030079485848546028,-0.2251616269350052,0.11288020014762878,-0.18456566333770752,0.15460479259490967,0.03485236316919327,0.14440228044986725,-0.22155757248401642,0.1638929694890976,0.11319119483232498,0.17816118896007538,-0.16432155668735504,-0.32900938391685486,-0.38405197858810425,0.15876539051532745,0.314615935087204,-0.193285271525383,-0.3143264949321747,0.24753589928150177,0.2189219743013382,-0.30014681816101074,0.16097049415111542,0.13033318519592285,0.21526505053043365,0.15829342603683472,0.029679670929908752,0.05463017150759697,-0.05597059056162834,0.19497987627983093},{-0.19419100880622864,0.0691896378993988,-0.0741400420665741,-0.09696310758590698,-0.2571040093898773,-0.16555137932300568,0.1265711635351181,0.015418765135109425,-0.2774551510810852,0.06751015037298203,0.3055007755756378,-0.11723893135786057,0.16638542711734772,-0.22170941531658173,-0.11999241262674332,0.24304616451263428,-0.24503177404403687,0.07182925939559937,-0.3082970082759857,-0.16358621418476105,0.12135640531778336,0.019237013533711433,0.416209876537323,0.15408065915107727,-0.06830045580863953,-0.18826262652873993,-0.017318839207291603,0.1181303933262825,0.21260225772857666,-0.21271510422229767,-0.09510640799999237,0.046842169016599655},{-0.04545354098081589,0.18694867193698883,0.007235839497298002,0.07435289025306702,0.3051234483718872,-0.0690339058637619,0.05842060223221779,0.19837966561317444,-0.2551724314689636,0.12076278775930405,0.017712721601128578,0.09289783984422684,-0.18298782408237457,0.40870264172554016,0.04793766885995865,-0.01471556443721056,0.13899452984333038,0.07908979058265686,0.024640141054987907,0.2427152544260025,-0.2086883783340454,0.07961875945329666,-0.12411962449550629,0.2245027720928192,0.07933469116687775,0.009897698648273945,0.22364357113838196,-0.20053938031196594,0.22404645383358002,0.19763337075710297,-0.20743674039840698,-0.17514945566654205},{-0.20526261627674103,0.26720985770225525,0.03825686499476433,0.026713499799370766,-0.12611497938632965,0.29113757610321045,-0.022576455026865005,-0.04907967895269394,0.019179366528987885,-0.24054642021656036,-0.07346072793006897,-0.23047375679016113,-0.1347668319940567,0.08922947943210602,0.024578038603067398,-0.26070937514305115,0.1779468059539795,0.05740805342793465,0.18881630897521973,0.17716139554977417,-0.14964993298053741,-0.3075854778289795,-0.09556117653846741,0.305477499961853,0.25722989439964294,0.2433900535106659,0.09395395964384079,0.07449127733707428,0.04000864550471306,0.03358598053455353,-0.28921371698379517,0.220415860414505},{0.05555379018187523,0.010053216479718685,0.06953790783882141,-0.18606573343276978,0.2528383731842041,0.3764030635356903,0.2786642014980316,-0.24462907016277313,0.15815766155719757,0.2939572334289551,0.17291486263275146,-0.17401237785816193,-0.011311030015349388,-0.14159296452999115,-0.18402495980262756,-0.11857401579618454,-0.07230205088853836,-0.23181447386741638,-0.43321090936660767,-0.24555204808712006,-0.0009121941984631121,-0.0040441881865262985,0.14433316886425018,0.20578455924987793,-0.07229755818843842,0.011299488134682178,0.10800421237945557,-0.218526229262352,-0.01774214208126068,0.05206959322094917,0.10957756638526917,0.2123245894908905},{0.18981963396072388,-0.1261058896780014,0.3025917112827301,0.2685870826244354,0.043710414320230484,-0.2110045999288559,0.07097572833299637,-0.18303894996643066,-0.17657549679279327,-0.0027211084961891174,0.28801020979881287,0.15102674067020416,0.06060468778014183,0.14555346965789795,0.1919560730457306,0.1590493768453598,0.11465204507112503,0.21868303418159485,-0.027893776074051857,0.14393535256385803,-0.13608062267303467,-0.2699719965457916,-0.17617788910865784,-0.014956279657781124,0.19880999624729156,-0.31785404682159424,-0.308725506067276,0.23846668004989624,-0.1343611478805542,-0.2325553447008133,-0.22855372726917267,0.2099951058626175},{0.11849977821111679,0.2877048850059509,0.36141300201416016,0.33933892846107483,0.07424307614564896,0.182745561003685,-0.33092138171195984,-0.014182837679982185,-0.057944513857364655,-0.14339952170848846,-0.3839420676231384,-0.04670234024524689,-0.04337445646524429,-0.4463638365268707,0.2575487792491913,-0.14841128885746002,-0.4237131178379059,0.37407875061035156,0.18727238476276398,-0.017698705196380615,0.09174688905477524,-0.06362272799015045,0.19025439023971558,-0.02270917221903801,-0.18960408866405487,-0.055725112557411194,0.30617061257362366,-0.23268041014671326,-0.08997797966003418,0.2643434703350067,0.0344524011015892,-0.12026624381542206},{-0.11208975315093994,-0.19297754764556885,-0.11774162203073502,-0.13182976841926575,-0.2507665753364563,-0.3375515937805176,0.12339954823255539,-0.2761409878730774,-0.26197004318237305,0.23300574719905853,0.17991644144058228,0.2569718062877655,-0.2261282056570053,-0.23396500945091248,0.12340689450502396,0.17161032557487488,-0.02923840656876564,0.012059793807566166,0.10130294412374496,-0.27166086435317993,-0.06783626228570938,-0.09541139751672745,-0.03126984089612961,-0.1491418033838272,0.23120130598545074,-0.018354199826717377,0.08240234851837158,-0.21884606778621674,-0.30425286293029785,-0.013655954971909523,0.13710443675518036,0.17145290970802307},{-0.3321717083454132,-0.07943716645240784,0.2076244354248047,0.17837445437908173,-0.12281093746423721,0.1959637999534607,-0.03992597386240959,0.04647378623485565,0.07511834055185318,0.011231103911995888,-0.07925590127706528,0.3791157305240631,0.27688083052635193,-0.2979479730129242,-0.1733509600162506,-0.08500661700963974,0.019684989005327225,0.14120134711265564,0.09462209790945053,-0.016778403893113136,0.18161767721176147,0.02682056464254856,-0.20402374863624573,-0.14914226531982422,0.18513529002666473,0.042226407676935196,0.1894964575767517,-0.3049429953098297,-0.24052083492279053,0.12574459612369537,0.3741534948348999,-0.22652141749858856},{0.26389846205711365,0.010346542112529278,0.18264712393283844,0.21472908556461334,0.2378881573677063,0.09964549541473389,-0.1783999651670456,-0.05102831497788429,0.010404265485703945,-0.1798783242702484,0.052072927355766296,-0.21737702190876007,0.22082370519638062,-0.08240024000406265,0.30232706665992737,0.10517968237400055,-0.038321901112794876,0.08280349522829056,0.10105906426906586,0.09331241995096207,-0.06812523305416107,-0.30428603291511536,-0.15446624159812927,-0.01664465107023716,0.1899080127477646,0.0951700434088707,0.06558965146541595,0.22850418090820312,-0.07966728508472443,-0.16689391434192657,0.3305876553058624,0.3209977447986603},{0.2908863127231598,-0.06169116869568825,-0.023236606270074844,-0.30858689546585083,-0.24069122970104218,-0.2854365408420563,0.03528668358922005,0.12816333770751953,-0.09410137683153152,0.13572688400745392,-0.34067943692207336,-0.15496014058589935,0.0707482397556305,0.06635840982198715,-0.225013867020607,-0.09481502324342728,-0.026745842769742012,0.013304619118571281,-0.3088793456554413,0.15579542517662048,0.017476268112659454,-0.057274047285318375,-0.1526564210653305,0.06358617544174194,0.04756779968738556,-0.0556131973862648,0.12873110175132751,0.07273334264755249,-0.0027173259295523167,-0.2828819155693054,-0.16542497277259827,0.4030379056930542},{-0.020999202504754066,0.141337051987648,-0.3318682610988617,-0.3064987361431122,0.11843764781951904,-0.06734566390514374,-0.02974070981144905,-0.25816020369529724,0.21463847160339355,-0.15506935119628906,0.07040528953075409,0.16421230137348175,-0.061739981174468994,-0.040451593697071075,-0.2329697608947754,0.13589094579219818,0.22686105966567993,-0.12275480479001999,0.14320211112499237,-0.08892839401960373,0.2020767629146576,-0.16103355586528778,-0.02596541866660118,0.21566306054592133,-0.27222689986228943,-0.12443111836910248,0.1984439343214035,-0.008344491012394428,-0.25002726912498474,-0.14869239926338196,0.15785986185073853,0.10910677909851074},{0.21397380530834198,0.13353654742240906,-0.029675958678126335,-0.32875457406044006,-0.2677953541278839,0.2917180359363556,-0.25233742594718933,0.021364854648709297,-0.13765694200992584,0.2104482799768448,-0.026715150102972984,-0.10483752936124802,0.06422284990549088,0.29988741874694824,0.20407399535179138,0.11368244886398315,-0.10024084150791168,-0.30708518624305725,0.13627766072750092,-0.2307923585176468,-0.05144412815570831,-0.0010346694616600871,0.1685013473033905,0.287458598613739,0.045793842524290085,0.047448281198740005,0.10125371813774109,-0.08085969090461731,-0.15993647277355194,-0.2943142354488373,0.1456073820590973,0.1472877860069275}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.13032378256320953,-0.27184998989105225,-0.29600363969802856,-0.2112983614206314},{-0.12222063541412354,0.011006511747837067,0.16870003938674927,0.04519858956336975},{0.02961600013077259,0.024426110088825226,-0.030138345435261726,-0.25966617465019226},{-0.019293226301670074,0.10235796868801117,0.03957454860210419,-0.15455561876296997},{-0.05299757421016693,-0.08657067269086838,-0.3334895670413971,-0.12662050127983093},{-0.2168644517660141,-0.29845571517944336,0.07520570605993271,-0.12184292078018188},{-0.038343023508787155,-0.25222039222717285,0.34342584013938904,-0.24192745983600616},{0.29179272055625916,0.09744272381067276,0.0848265290260315,0.3219178318977356},{-0.0004049705748911947,0.06998874247074127,-0.01170612033456564,0.18323326110839844},{-0.22616669535636902,-0.19953671097755432,-0.2473280429840088,-0.060628827661275864},{0.266612708568573,-0.1944105327129364,-0.18669486045837402,0.11921565234661102},{-0.13694730401039124,0.20174244046211243,0.10030199587345123,-0.11548607796430588},{0.3165946304798126,-0.07137751579284668,-0.3131338655948639,-0.37927699089050293},{-0.07741501182317734,-0.13812367618083954,-0.04188067838549614,0.190690815448761},{0.33406758308410645,-0.21086138486862183,-0.37065455317497253,-0.19461195170879364},{0.17175686359405518,-0.09510929882526398,-0.0006880019791424274,0.13642574846744537},{-0.03229452669620514,-0.35790279507637024,-0.3217207193374634,-0.06767239421606064},{0.1832422912120819,0.16229544579982758,0.08277332782745361,-0.3105598986148834},{0.23884284496307373,0.45564159750938416,0.03157150000333786,0.35663649439811707},{-0.2165965586900711,0.10764484107494354,-0.2597755789756775,0.14826661348342896},{0.0751577690243721,-0.17817699909210205,-0.03573758155107498,0.004962211009114981},{0.1668342500925064,0.30956655740737915,-0.04524965584278107,0.11478781700134277},{0.023158855736255646,-0.16655011475086212,-0.04099290817975998,-0.2839409112930298},{0.21726636588573456,-0.18429431319236755,-0.05698377266526222,0.15307752788066864},{0.23454628884792328,0.2050565630197525,0.11814916878938675,-0.061813224107027054},{-0.2856418192386627,0.1048077717423439,-0.12296679615974426,-0.13100484013557434},{0.09219015389680862,0.10763475298881531,0.09075331687927246,0.12611204385757446},{-0.20493505895137787,-0.10928413271903992,-0.3162078559398651,-0.3655533194541931},{0.21114058792591095,-0.31266263127326965,0.3463345468044281,-0.22994102537631989},{-0.20854312181472778,-0.15048101544380188,-0.20535971224308014,-0.1329091489315033},{-0.16798700392246246,0.01171368733048439,0.10073746740818024,-0.305637925863266},{0.05250028148293495,-0.30601751804351807,-0.2025953084230423,-0.31592750549316406}};
static const float actor_encoder_neighbor_encoder_embedding_mlp_0_bias[8] = {-0.04431425780057907,0.052658576518297195,0.011968918144702911,0.0411788709461689,-0.029321013018488884,-0.029588723555207253,-0.02417852357029915,-0.02330831252038479};
static const float actor_encoder_neighbor_encoder_embedding_mlp_2_bias[8] = {0.042025670409202576,0.03298477083444595,-0.03886318951845169,-0.027643555775284767,0.01051065232604742,0.09911768138408661,0.01838763989508152,0.008497054688632488};
static const float actor_encoder_self_encoder_0_bias[16] = {0.12990792095661163,-0.0387335941195488,-0.06082433834671974,0.10477209836244583,-0.017580615356564522,-0.09113451838493347,0.19375915825366974,-0.09110600501298904,-0.036217980086803436,0.08232924342155457,0.04575665667653084,0.06861304491758347,0.0033227289095520973,0.09314605593681335,-0.08234596997499466,-0.15621012449264526};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.012459092773497105,0.02291237562894821,-0.07557495683431625,0.022780241444706917,0.07679133117198944,0.056212667375802994,-0.024756506085395813,0.08503756672143936,0.019951827824115753,0.00907842256128788,0.0734083279967308,-0.024890460073947906,0.1445738822221756,0.002837248845025897,0.03545929118990898,0.07503557205200195};
static const float actor_encoder_feed_forward_0_bias[32] = {0.017223332077264786,0.023595374077558517,0.01025467086583376,-0.033989403396844864,-0.02485356479883194,0.008685339242219925,-0.015692591667175293,0.01957382634282112,-0.04251830279827118,0.040320079773664474,-0.017770761623978615,-0.05015290528535843,-0.04024809971451759,0.012851135805249214,-0.03358600288629532,0.022950423881411552,0.006496035493910313,-0.0278767179697752,-0.05331411957740784,-0.0018005691235885024,0.043428052216768265,-0.08877705782651901,0.014305444434285164,0.0006418224656954408,-0.03022921085357666,-0.0598040409386158,-0.004952183924615383,0.00016110892465803772,0.030521061271429062,0.04503537341952324,0.02132880873978138,0.02488749660551548};
static const float action_parameterization_distribution_linear_bias[4] = {-0.025194644927978516,-0.041979484260082245,0.027126913890242577,0.006800491362810135};
void neighborEmbeddings(const float neighbors_array[NEIGHBORS][NUM_OBS]) {
  //reset embeddings accumulator to zero
  memset(neighbor_embeds, 0, sizeof(neighbor_embeds));

  // get the neighbor embeddings
  for (int n = 0; n < NEIGHBORS; n++) {
    for (int i = 0; i < structure[2][1]; i++) {
      output_2[i] = 0;
      for (int j = 0; j < structure[2][0]; j++) {
        output_2[i] += neighbors_array[n][j] * actor_encoder_neighbor_encoder_embedding_mlp_0_weight[j][i];
      }
      output_2[i] += actor_encoder_neighbor_encoder_embedding_mlp_0_bias[i];
      output_2[i] = tanhf(output_2[i]);
    }

    for (int i = 0; i < structure[3][1]; i++) {
      output_3[i] = 0;
      for (int j = 0; j < structure[3][0]; j++) {
        output_3[i] += output_2[j] * actor_encoder_neighbor_encoder_embedding_mlp_2_weight[j][i];
      }

      output_3[i] += actor_encoder_neighbor_encoder_embedding_mlp_2_bias[i];
      output_3[i] = tanhf(output_3[i]);
      neighbor_embeds[i] += output_3[i];
    }
  }

  int self_size = structure[1][1]; // size of self embeddings. Need to offset by this much in the embedding array
  // get mean embeddings
  for (int i = 0; i < structure[3][1]; i++) {
    embedding_array[i+self_size] = neighbor_embeds[i] / NEIGHBORS;
  }
}

void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
  // first get the self embeddings
  for (int i = 0; i < structure[0][1]; i++) {
    output_0[i] = 0;
    for (int j = 0; j < structure[0][0]; j++) {
      output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i]; // add weights
    }
    output_0[i] += actor_encoder_self_encoder_0_bias[i]; // add bias
    output_0[i] = tanhf(output_0[i]); // activation function
  }

  for (int i = 0; i < structure[1][1]; i++) {
    embedding_array[i] = 0;
    for (int j = 0; j < structure[1][0]; j++) {
      embedding_array[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
    }
    embedding_array[i] += actor_encoder_self_encoder_2_bias[i];
    embedding_array[i] = tanhf(embedding_array[i]);
  }


  // last layer(s)
  for (int i = 0; i < structure[4][1]; i++) {
    output_4[i] = 0;
    for (int j = 0; j < structure[4][0]; j++) {
      output_4[i] += embedding_array[j] * actor_encoder_feed_forward_0_weight[j][i];
    }
    output_4[i] += actor_encoder_feed_forward_0_bias[i];
    output_4[i] = tanhf(output_4[i]);
  }


  for (int i = 0; i < structure[5][1]; i++) {
    output_5[i] = 0;
    for (int j = 0; j < structure[5][0]; j++) {
      output_5[i] += output_4[j] * action_parameterization_distribution_linear_weight[j][i];
    }
    output_5[i] += action_parameterization_distribution_linear_bias[i];
  }

  control_n->thrust_0 = output_5[0];
  control_n->thrust_1 = output_5[1];
  control_n->thrust_2 = output_5[2];
  control_n->thrust_3 = output_5[3];
}

//int main()
//{
////	std::vector<float> state{0.165928, 0.942265, 0.683338, 0.476424, 0.175134, 0.393026, 0.37596, 0.173734, 0.937535, 0.15913, 0.967515, 0.620271, 0.406, 0.990523, 0.404797, 0.968619, 0.853021, 0.956329};
////	std::vector<float> state{0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0};
//  std::vector<std::vector<float>> states{
//          {0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {0, 0, 2, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {0, 0, -1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {0, 0, -2, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {2, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {-1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {-2, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {0, 2, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {0, -1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {0, -2, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//          {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0},
//  };
//
//
////  float neighbor_obs_rel{
////          {5, 5, 5, 0, 0, 0}, // neighbor to my top right moving towards me
////          {-5, -5, -5, 0, 0, 0}, // neighbor to my left moving away from me
////  };
//
////  float neighbor_obs[1][6] =
//
//  const float neighbor_obs[2][6] = {
//          {0.5, 0, 1, 0, 0, 0},
//          { 0.13411005, -0.48878977, -2.10056613,  1.36485453, -0.72864023,
//                            -1.82551435}
//  };
//
////  const float neighbor_obs[1][6] = {
////          {0.5, 0, 0, 0, 0, 0}, // neighbor to my top right moving towards me
////  };
//
//
////	std::random_device rnd_device;
////	std::mt19937 rng{ rnd_device() };
////	std::uniform_real_distribution<> dist{0, 1};
////	std::generate(std::begin(state), std::end(state), [&]() {return dist(rng); });
//  for(std::vector<float> state: states) {
//    std::cout << "State: ";
//    for (auto x : state)
//    std::cout << x << ' ';
////
////    control_t_n motorThrusts;
////    neighborEmbeddings(neighbor_obs);
////    networkEvaluate(&motorThrusts, state.data());
//
//    for(int i = 0; i < 2; i++) {
//      const float * neighbor = neighbor_obs[i];
//      std::cout << "Neighbor state: ";
//      for (int j = 0; j < 6; j++){
//        std::cout << neighbor[j] << ' ';
//      }
//    }
//    control_t_n motorThrusts;
//    neighborEmbeddings(neighbor_obs);
//    networkEvaluate(&motorThrusts, state.data());
//
//    std::cout << "Controls: ";
//    std::cout << motorThrusts.thrust_0 << ' ' << motorThrusts.thrust_1 << ' ' << motorThrusts.thrust_2 << ' ' << motorThrusts.thrust_3 << std::endl;
//  }
////	std::cout << "State:\n";
////	for (auto x : state)
////		std::cout << x << ' ';
////	std::cout << '\n';
////
////	control_t_n motorThrusts;
////	networkEvaluate(&motorThrusts, state.data());
////
////	std::cout << "Controls:\n";
////	std::cout << motorThrusts.thrust_0 << ' ' << motorThrusts.thrust_1 << ' ' << motorThrusts.thrust_2 << ' ' << motorThrusts.thrust_3;
//
//  return EXIT_SUCCESS;
//}